//////////////////////////////////////////////////////////////////////////
//
// zzy disasm engine
//
// author: zzy
//
//////////////////////////////////////////////////////////////////////////


#ifndef _ZZY_DISASM_ENGINE_H_
#define _ZZY_DISASM_ENGINE_H_


//////////////////////////////////////////////////////////////////////////


#include "../blpp_typedef.h"
#include "decompose.h"


//////////////////////////////////////////////////////////////////////////


typedef struct _ZZY_DIS_CONTEXT *PZZY_DIS_CONTEXT;


//////////////////////////////////////////////////////////////////////////


PZZY_DIS_CONTEXT DisEng_AllocateContext();
T_void DisEng_FreeContext(PZZY_DIS_CONTEXT pContext);
T_void DisEng_SetCpuType(PZZY_DIS_CONTEXT pContext,int n);
int DisEng_Disasm(
	PZZY_DIS_CONTEXT pContext,
	T_Qword base,
	T_Qword ip,
	PCT_void data,
	PT_str strBuffer,
	PDisEng_DECOMPOSED pDecomposed);


//////////////////////////////////////////////////////////////////////////


#endif // _ZZY_DISASM_ENGINE_H_
